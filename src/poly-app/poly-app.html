<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/font-roboto/roboto.html">

<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../bower_components/paper-radio-group/paper-radio-group.html">

<link rel="import" href="../../bower_components/app-layout/app-layout.html">

<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">

<!-- link rel="import" href="../../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html"-->
<link rel="import" href="../../bower_components/app-layout/app-drawer/app-drawer.html">

<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/effects/waterfall.html">

<link rel="import" href="../../bower_components/app-layout/app-header/app-header.html">
<!-- link rel="import" href="../../bower_components/app-layout/app-header-layout/app-header-layout.html"-->
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">

<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">

<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<link rel="import" href="temp-sensor/temp-sensor.html">


<dom-module id="poly-app">
    <template>
    <style>
      :host {
        display: block;
         padding: 16px;
         font-family: 'Roboto', 'Noto', sans-serif;
         background-color: #eee;
      }

      app-header {
        background-color: #4285f4;
        color: #fff;
      }
      app-header paper-icon-button {
        --paper-icon-button-ink-color: #fff;
      }
      app-drawer-layout {
        --app-drawer-layout-content-transition: margin 0.2s;
      }


      app-drawer {
        --app-drawer-scrim-background: rgba(0, 0, 100, 0.5);
        --app-drawer-content-container: {
          background-color: #B0BEC5;
        }
      }

      .drawer-content {
        padding: 16px;
        overflow: auto;
      }

      .caption {
        padding-left: 12px;
        color: #a0a0a0;
      }

    </style>

    <app-header reveals effects="waterfall">
      <app-toolbar>
        <paper-icon-button id="toggle" icon="menu"></paper-icon-button>
        <div main-title> Home control </div>
        </app-toolbar>
    </app-header>
    <br/>
    <temp-sensor name="Kitchen" sensor={{kitchen}}></temp-sensor>
    <temp-sensor name="Entry room"></temp-sensor>
    <temp-sensor name="Heater"></temp-sensor>
    <temp-sensor name="Reverse"></temp-sensor>


    <br/>
    <div>Desired t: <span id="desired_temp_label" class="caption"></span>&#8451;</div><br>
    <paper-slider id="desired_temp" pin snaps min="10" max="22" max-markers="12" step="1"></paper-slider>

    <iron-ajax
               id="requestStatus"
               url="http://sasha123.ddns.ukrtel.net:1234/control/currentState"
               handle-as="json"
               on-response="_handleResponse">
               <div>ajax</div>
    </iron-ajax>


        <app-drawer id="drawer" swipe-open>
            <div class="drawer-content">
            <h2>[[prop1]]</h2>

            <label id="label1">Boiler pump:</label>
            <br/>
            <hr/>
            <paper-radio-group name="boiler_pump" selected="auto">
                <paper-radio-button name="auto">Auto</paper-radio-button>
                <br/>
                <paper-radio-button name="on">On</paper-radio-button>
                <br/>
                <paper-radio-button name="off">Off</paper-radio-button>
            </paper-radio-group>
            <br/>
            </br>
            <label id="label2">Boiler:</label>
            <br/>
            <hr/>
            <paper-radio-group name="boiler" selected="auto">
                <paper-radio-button name="auto">Auto</paper-radio-button>
                <br/>
                <paper-radio-button name="on">On</paper-radio-button>
                <br/>
                <paper-radio-button name="off">Off</paper-radio-button>
            </paper-radio-group>
            <br/>
          </div>
        </app-drawer>

  </template>

    <script>
        class MyApplication extends Polymer.Element {
            static get is() {
                return 'poly-app';
            }
            static get properties() {
                return {
                    prop1: {
                        type: String,
                        value: 'Home Control'
                    },
                    kitchen: {
                      type: Number,
                      readOnly: false,
                      notify: true,
                      value: 0,
                      reflectToAttribute: true
                    }


                };
            }

            ready() {
                super.ready();
                //var desired_temp = document.querySelector('#desired_temp');
                /*
                this.$.desired_temp.addEventListener('value-change', function () {
                  console.log("triggered");
                });
                */
                this.$.desired_temp.addEventListener('value-change', e => {
                    this._desired_temp_changed(e)
                });

                var drawer = this.$.drawer;
                this.$.toggle.addEventListener('tap', function() {
                    drawer.toggle();
                });

                this.$.requestStatus.generateRequest();
            }

            _handleResponse(data) {
                  console.log(data.detail.response);
                  this.kitchen = data.detail.response.TempInside;
            };

            _desired_temp_changed(e) {
                this.$.desired_temp_label.textContent = this.$.desired_temp.value;
                console.log("triggered");
            };

        }

        window.customElements.define(MyApplication.is, MyApplication);
    </script>
</dom-module>
